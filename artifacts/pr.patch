diff --git a/lan_app/templates/recording_detail.html b/lan_app/templates/recording_detail.html
index 91b9eb3..be788ad 100644
--- a/lan_app/templates/recording_detail.html
+++ b/lan_app/templates/recording_detail.html
@@ -63,10 +63,12 @@
       {% endif %}
     </p>
     {% endif %}
-    {% if rec.status in ['Ready', 'NeedsReview'] %}
+    {% if rec.status in ['Ready', 'NeedsReview'] and rec.project_id %}
     <form method="post" action="/ui/recordings/{{ rec.id }}/publish">
       <button type="submit" class="btn">Publish to OneNote</button>
     </form>
+    {% elif rec.status in ['Ready', 'NeedsReview'] %}
+    <p class="placeholder">Assign this recording to a project before publishing to OneNote.</p>
     {% else %}
     <p class="placeholder">Publish is available only for Ready or NeedsReview recordings.</p>
     {% endif %}
diff --git a/tests/test_onenote.py b/tests/test_onenote.py
index 3062895..acd7f1c 100644
--- a/tests/test_onenote.py
+++ b/tests/test_onenote.py
@@ -314,11 +314,13 @@ def test_recording_overview_publish_controls(tmp_path: Path, monkeypatch):
     monkeypatch.setattr(api, "_settings", cfg)
     monkeypatch.setattr(ui_routes, "_settings", cfg)
     init_db(cfg)
+    project = create_project("UI Publish", settings=cfg)
     create_recording(
         "rec-ui-publish-1",
         source="drive",
         source_filename="ui-publish.mp3",
         status=RECORDING_STATUS_READY,
+        project_id=project["id"],
         settings=cfg,
     )
 
@@ -338,6 +340,28 @@ def test_recording_overview_publish_controls(tmp_path: Path, monkeypatch):
     assert "Open OneNote page" in after.text
 
 
+def test_recording_overview_hides_publish_without_project_assignment(
+    tmp_path: Path, monkeypatch
+):
+    cfg = _cfg(tmp_path)
+    monkeypatch.setattr(api, "_settings", cfg)
+    monkeypatch.setattr(ui_routes, "_settings", cfg)
+    init_db(cfg)
+    create_recording(
+        "rec-ui-no-project-1",
+        source="drive",
+        source_filename="ui-no-project.mp3",
+        status=RECORDING_STATUS_READY,
+        settings=cfg,
+    )
+
+    client = TestClient(api.app, follow_redirects=True)
+    page = client.get("/recordings/rec-ui-no-project-1?tab=overview")
+    assert page.status_code == 200
+    assert "Publish to OneNote" not in page.text
+    assert "Assign this recording to a project before publishing to OneNote." in page.text
+
+
 def test_recording_overview_does_not_link_graph_api_when_page_url_missing(
     tmp_path: Path, monkeypatch
 ):
